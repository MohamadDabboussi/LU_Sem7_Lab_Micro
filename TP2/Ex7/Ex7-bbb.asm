OUT EQU 0
WAIT EQU 1
NEXT EQU 2
X_C EQU 0
Y_C EQU 2
COM EQU 4
DRAWPAD EQU $E020

 ORG $2000
S1 DC.B $04 ; OUTPUT
   DC.B $00 ; WAIT TIME
   DC.W S1,S1,S1,S1,S1,S1,S1,S1,S1,S1,S1,S1,S2,S1,S1,S1
S2 DC.B $80 ; OUTPUT
   DC.B $00 ; WAIT TIME
   DC.W S2,S3,S2,S2,S2,S2,S2,S2,S2,S2,S2,S2,S2,S2,S2,S2
S3 DC.B $01 ; OUTPUT
   DC.B $20 ; WAIT TIME
   DC.W S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4
S4 DC.B $40 ; OUTPUT
   DC.B $00 ; WAIT TIME
   DC.W S4,S4,S5,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4,S4
S5 DC.B $02 ; OUTPUT
   DC.B $10 ; WAIT TIME
   DC.W S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6
S6 DC.B $40 ; OUTPUT
   DC.B $00 ; WAIT TIME
   DC.W S6,S6,S6,S6,S1,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6,S6
STATEPT DS.W 1 ; STATE POINTER

 ORG $1000 ; MAIN PROGRAM
 MOVEA.L #S1,A0
 MOVE.W A0,STATEPT
FSM
 MOVEA.W STATEPT,A0
 Move.B OUT(A0),$E003
 Move.B OUT(A0),D2
 ANDI.W #$0F,D2
 cmp.b #$00,D2
 beq ctn
 LSR #1,D2
 MULU.W #80,D2
 Move.W #200,A2
 SUB.W D2,A2
 LEA DRAWPAD,A1
 MOVE.W A2,X_C(A1)
 MOVE.W #100,Y_C(A1)
 MOVE.W #$0008,COM(A1)
 ADD.W #40,A2
 MOVE.W A2,X_C(A1)
 MOVE.W #120,Y_C(A1)
 MOVE.W #$2772,COM(A1)
ctn
 MOVE.B WAIT(A0),D0
 BSR DELAY
 MOVE.B $E001,D1
 ANDI.W #$0F,D1
 LSL.W #$01,D1
 ADD.W D1,A0
 MOVE.W NEXT(A0),STATEPT
 Move.W #$0000,$E024
 BRA FSM
DELAY ; TIME = D0 SECOND
 CMP.B #0,D0
 BEQ FIN
 MOVE.L #$FFD00000,D2
LOOP
 ADD.L #$01,D2
 BNE LOOP
 ADD.L #$FFFFFFFF,D0
 BNE DELAY
FIN
 RTS
 END $1000